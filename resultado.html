<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Resultado</title>
    <link rel="stylesheet" href="resultado.css">
</head>
<body>
    <div id="formContainer" class="form-container"></div>
        <!-- El contenido generado se insertará aquí -->
    </div>
    <div id="formResumen" class="form-container"></div>
        <!-- El contenido generado se insertará aquí -->
    </div>
    <script src="simplex.js"></script>
    <script>
        window.onload = function() {
            // Obtener los datos de localStorage
            let BVS = JSON.parse(localStorage.getItem('arregloVariablesBasicas'));
            let variables = JSON.parse(localStorage.getItem('arregloVariables'));
            let matriz = JSON.parse(localStorage.getItem('matriz'));
    
            var formContainer = document.getElementById('formContainer');

            var label = document.createElement('label');
            label.textContent = 'Matriz:';
            formContainer.appendChild(label); 

            // Verificar si los datos se obtuvieron correctamente
            if (BVS && variables && matriz) {
                // Crear la tabla
                let table = document.createElement('table');
                table.setAttribute('border', '1');
                let tbody = document.createElement('tbody');
    
                // Crear la fila de encabezado con las variables
                let headerRow = document.createElement('tr');
                let emptyCell = document.createElement('th');
                emptyCell.textContent = 'BVS';
                headerRow.appendChild(emptyCell);  // Célula vacía en la esquina superior izquierda
                variables.forEach(function(variable) {
                    let th = document.createElement('th');
                    th.textContent = variable;
                    headerRow.appendChild(th);
                });
                let rhs = document.createElement('th');
                rhs.textContent = 'RHS';
                headerRow.appendChild(rhs);
                tbody.appendChild(headerRow);
    
                // Crear las filas de la matriz con las variables básicas
                BVS.forEach(function(bvs, rowIndex) {
                    let row = document.createElement('tr');
    
                    // Crear la primera célula con la variable básica
                    let th = document.createElement('th');
                    th.textContent = bvs;
                    row.appendChild(th);
    
                    // Añadir los valores de la matriz en esa fila
                    matriz[rowIndex].forEach(function(value) {
                        let td = document.createElement('td');
                        td.textContent = value;
                        row.appendChild(td);
                    });
    
                    tbody.appendChild(row);
                });
    
                // Añadir el tbody a la tabla y la tabla al documento
                table.appendChild(tbody);
                formContainer.appendChild(table);
            } else {
                console.error("No se encontraron los datos en localStorage");
            }
            
            // Crear un contenedor para los botones
            var buttonContainer = document.createElement('div');
            buttonContainer.className = 'button-container'; // Agregar clase para estilos

            // Crear el botón "Continuar"
            var continueButton = document.createElement('button');
            continueButton.type = 'button';
            let bandera = +localStorage.getItem("bandera");
            let nSol = +localStorage.getItem("cantidadSoluciones");
            //bandera=1;
            if (bandera == 0 || nSol ) {
                continueButton.onclick = inicio; 
            } else {
                continueButton.onclick = null; 
                continueButton.disabled = true;
            }
            continueButton.textContent = 'Continuar';
            buttonContainer.appendChild(continueButton);

            // Crear el botón "Volver al inicio"
            var backButton = document.createElement('button');
            backButton.type = 'button';
            backButton.onclick = function() { window.location.href = "main.html"; };
            backButton.textContent = 'Volver al inicio';
            buttonContainer.appendChild(backButton);

            // Añadir el contenedor de botones al formContainer
            formContainer.appendChild(buttonContainer);

            // Crear un contenedor para el resumen de iteración
            var formResumen = document.getElementById('formResumen');

            //DETECTE BANDERA IF EN 1
            if (bandera == 1) {
                let resumenIteracion = JSON.parse(localStorage.getItem("resumenIteracion"));
                var label = document.createElement('label');
                label.textContent = 'Resumen Iteraciones:';
                formResumen.appendChild(label); 

                // Crear la tabla para el resumen de iteración
                let resumenTable = document.createElement('table');
                resumenTable.setAttribute('border', '1');
                let resumenTbody = document.createElement('tbody');

                variables = JSON.parse(localStorage.getItem("varOriginal"));
                // Crear la fila de encabezado con las variables
                let resumenHeaderRow = document.createElement('tr');
                variables.forEach(function(variable) {
                    let th = document.createElement('th');
                    th.textContent = variable;
                    resumenHeaderRow.appendChild(th);
                });
                let th = document.createElement('th');
                th.textContent = 'Z';
                resumenHeaderRow.appendChild(th);
                // Añadir el encabezado al tbody
                resumenTbody.appendChild(resumenHeaderRow);

                // Crear las filas de la matriz con los valores de resumenIteracion
                resumenIteracion.forEach(function(fila) {
                    let row = document.createElement('tr');

                    // Añadir los valores de la matriz en esa fila
                    fila.forEach(function(value) {
                        let td = document.createElement('td');
                        td.textContent = value;
                        row.appendChild(td);
                    });

                    resumenTbody.appendChild(row);
                });

                // Añadir el tbody a la tabla y la tabla al contenedor de resumen
                resumenTable.appendChild(resumenTbody);
                formResumen.appendChild(resumenTable);
            }
        };
    </script>
    
</body>
</html>